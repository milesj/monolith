---
title: Generating code
---

## Creating a new template

To create a new template, run [`moon generate`][command] while passing the `--template` option. This
will create a template directory and [`template.yml`][config] file in the 1st configured template
location defined in [`generator.templates`][gen-templates].

```shell
$ moon generate <name> --template
```

### Configuring `template.yml`

Every template requires a [`template.yml`][config] file in the template's directory root. This file
acts as a schema and declares metadata and variables required by the generator.

```yaml title="template.yml"
title: 'npm package'
description: |
  Scaffolds the initial structure for an npm package,
  including source and test folders, a package.json, and more.
variables:
  name:
    type: 'string'
    default: ''
    required: true
    prompt: 'Package name?'
```

### Managing files

Feel free to add any files and folders to the template that you'd like to be generated by consumers!
These files will then be scaffolded 1:1 in structure at the target destination. With that being
said, there are a few unique scenarios to be aware of!

- File paths that contain the word "partial" will not be scaffolded. This is to support composition
  and inheritance between templates using
  [`{% include ... %}`](https://tera.netlify.app/docs/#include).
- Variables can be interpolated into file paths using the form `[varName]`. For example, if you had
  a template file `src/[type].ts`, and a variable `type` with a value of "bin", then the destination
  file path would be `src/bin.ts`.

### Template engine & syntax

Rendering templates is powered by [Tera](https://tera.netlify.app/), a Rust based template engine
with syntax similar to Twig, Liquid, Jinja, and more. We highly encourage everyone to read Tera's
documentation for an in-depth understanding, but as a quick reference, Tera supports the following:

- [Variable interpolation](https://tera.netlify.app/docs/#variables) (defined with the
  [`variables`](../config/template#variables) setting), with
  [built-in filters](https://tera.netlify.app/docs/#built-ins).

```twig
{{ varName }} # foo
{{ varName | upper }} # FOO
```

- [Conditional blocks](https://tera.netlify.app/docs/#if) and
  [loops](https://tera.netlify.app/docs/#for).

```twig
{% if price < 10 or always_show %}
	Price is {{ price }}.
{% elif price > 1000 and not rich %}
	That's expensive!
{% else %}
	N/A
{% endif %}
```

```twig
{% for item in items %}
	{{ loop.index }} - {{ item.name }}
{% endfor %}
```

- And many more features, like auto-escaping, white space control, math operators!

## Sharing templates

Although moon is designed for a monorepo, you may be using multiple repositories and would like to
use the same templates across all of them.

This is technically possible, but with 1 caveat, and that is that moon's generator requires
templates to exist within the current repository, relative from the workspace root. So how can we
share templates across repositories? Why not try...

- git submodules
- npm packages
- other packaging system

Regardless of the choice, simply configure [`generator.templates`][gen-templates] to point to these
locations:

```yaml title=".moon/workspace.yml"
generator:
	templates:
		- './templates'
		- './node_modules/@company/shared-templates'
		- './path/to/submodules'
```

[config]: ../config/template
[command]: ../commands/generate
[gen-templates]: ../config/workspace#templates
